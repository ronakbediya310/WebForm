<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Registration Form</title>
     <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script> 
    

    <style>
      * {
        margin: 0;
      }
      #mytable
      {
        margin:0 auto;
        display:table;
        border: 2px solid rgb(106, 44, 44);
          text-align: center;
          width: 60%;
          margin-top: 20px;
          margin-bottom: 50px;
      }

      .container {
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        height: 100vh;
      }

      .container h1 {
        color: green;
      }

      .registartion-form {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 600px;
        font-size: 18px;
        background-color: #f0f0f0;
        padding: 20px;
        border: 2px solid green;
        border-radius: 20px;
      }

      .registartion-form input,
      .registartion-form select,
      .registartion-form textarea {
        padding: 5px;
        margin-top: 10px;
      }

      .registartion-form .submit {
        justify-content: center;
        align-items: center;
        width: 50%;
        height: 40px;
        font-size: 20px;
        color: #ffffff;
        border-radius: 10px;
        padding-top: 0px;
        background-color: green;
      }

      input,
      textarea,
      .datepicker,
      .selectpicker,
      .language {
        border-radius: 10px;
      }

      .submit {
        margin-left: 100px;
      }

      #message {
        padding-top: 10px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>Registration Form</h1>
      <form name="form" id="form" class="registartion-form" onsubmit="validate()" >
        <table>
          <tr>
            <td><label for="name">Username :</label></td>
            <td>
              <input
                type="text"
                name="name"
                id="name"
                placeholder="Enter your name"
                onblur="validateName()"
                
              />
            </td>
          </tr>
          <tr>
            <td><label for="email">Email :</label></td>
            <td>
              <input
                type="text"
                name="email"
                id="email"
                placeholder="Enter your email"
                onblur="validateEmail()"
                
              />
            </td>
          </tr>
          <tr>
            <td><label for="password">Password :</label></td>
            <td>
              <input
                type="password"
                name="password"
                id="password"
                placeholder="Enter Password"
                onblur="validatePass()"
                
              />
            </td>
          </tr>

          <tr>
            <td><label for="date">DOB : </label></td>
            <td>
              <input
                type="date"
                class="form-control"
                id="date"
                name="date"
                onblur="validateDate()"
                
              />
            </td>
          </tr>
          <tr>
            <td><input type="checkbox" id="tnc" /></td>
            <td>I agree to the terms and conditions</td>
          </tr>
          <tr>
            <td colspan="2">
              <input type="submit" class="submit" value="Register" onclick="return validate(event)"/>
            </td>
          </tr>
        </table>
      </form>
    </div>
    <h1 style="text-align: center;">Entries</h1>
     <table id="mytable" >
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Password</th>
            <th>Dob</th>
            <th>Accepted terms?</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>  
    <script>
      let date = document.getElementById("date");
      let todayDate = new Date();
      let dateflag = 0;
      function validateDate() {
        let tempDate = new Date(date.value);
        let diffTime = Math.abs(todayDate - tempDate);
        let diffYears = Math.ceil(diffTime / (1000 * 60 * 60 * 24 * 365.25));
        let name = document.getElementById("name").value;
        console.log(diffYears);
        if (diffYears > 18 && diffYears < 55) {
          dateflag = 1;
        }
        if (diffYears <= 18 || diffYears >= 55) {
          alert("Enter date between  18-55");
          dateflag = 0;
          date.value="";
        }
        if ((diffYears = "")) {
          alert("Enter Date");
          dateflag = 0;
        }
        return dateflag;
      }
      let nameflag = 0;
      let name = document.getElementById("name");
      function validateName() {
        console.log(name.value);
        if ((name.value == "" || NaN == name.value)) {
          alert("Please Enter valid name");
          name.value = "";
          nameflag = 0;
        } else {
          nameflag = 1;
        }
        return nameflag;
      }
      let passflag = 0;
      let pass = document.getElementById("password");

      function validatePass() {
        console.warn(pass.value);
        if (pass.value == "") {
          alert("PASSWORD CANT BE EMPTY");
          pass.value = "";
          passflag = 0;
        } else {
          passflag = 1;
        }
        return passflag;
      }

      let emailflag = 0;
      let email = document.getElementById("email");
      let emails= email.value;
      function validateEmail() {
        let emails=document.getElementById("email").value;
          let re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
          emailflag= re.test(String(emails).toLowerCase());
          console.log(emailflag);

          if(emailflag==0)  {
              alert("Please Enter Valid Email Address");
          }
          else{
            emailflag=1;
          }
          return emailflag;
      }
        
    let userData = JSON.parse(localStorage.getItem("user"));
    if (userData && Array.isArray(userData)) {
    let table = document.getElementById("mytable");
    for (let i = 0; i < userData.length; i++) {
    let row = table.insertRow();
    let nameCell = row.insertCell(0);
    let emailCell = row.insertCell(1);
    let passwordCell = row.insertCell(2);
    let dobCell = row.insertCell(3);
    let acceptcell= row.insertCell(4);

    nameCell.innerHTML = userData[i].name;
    emailCell.innerHTML = userData[i].email;
    passwordCell.innerHTML = userData[i].password;
    dobCell.innerHTML = userData[i].dob;
    acceptcell.innerHTML = userData[i].Accepted_terms;
}}
 function validate(event)
 {
    event.preventDefault();
 if(validateDate()&&validateEmail()&&validateName()&&validatePass())
     {
        let  check=document.getElementById("tnc");
        let acceptedterms=check.checked;
        console.log(acceptedterms);
        let data = JSON.parse(localStorage.getItem("user")) || [];
        let dob =date.value;
        let Username=document.getElementById("name").value;
        let email1=document.getElementById("email").value;
        let passwd=document.getElementById("password").value;   
          data.push({
            name: Username,
            email: email1,
            password: passwd,
            dob: dob,
            Accepted_terms:acceptedterms,
          });
          localStorage.setItem("user", JSON.stringify(data));
          const table = document.querySelector("#mytable tbody");
          const row = document.createElement("tr");
          row.innerHTML = `
          <td>${name}</td>
          <td>${email}</td>
          <td>${password}</td>
          <td>${dob}</td>
          <td>${acceptedterms}</td>`;
          table.appendChild(row);
            return true
        }
        else{
            return false;
        }
    }
      

      
      //localStorage.clear();
      
    </script>
  </body>
</html>
