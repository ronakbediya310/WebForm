<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>form validation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
    <style>
      *{
        font-weight: bolder;
        
      }
      body{
        margin-top: 100px;
      }
      #contain{
         display: flex;
         justify-content: center;
         align-items: center;
      }
    </style>
</head>
<body class="bg-dark text-light ">
    <div class="container-fluid mx-auto row ">
   <form id="user-form" onsubmit="return call()"  method="get" >
    <div class="form-group col-md-6 mx-auto ">
        <label for="name">Enter Name:</label>
         <input type="" name="Name" class="form-control" id="name" placeholder="Enter name" required>
   </div>
   <br><br>
  <div class="form-group col-md-6 mx-auto ">
    <label for="email">Email address:</label>
    <input type="email" name="email" class="form-control" id="email" aria-decribedby="emailHelp" placeholder="Enter email" required >
  </div>
  <br><br>
  <div class="form-group col-md-6 mx-auto ">
    <label for="Password">Password:</label>
    <input name="pass" type="password" class="form-control" id="password" placeholder="Enter Password" required >
  </div>
  <br><br>
  <div class="form-group col-md-6 mx-auto ">
    <label for="dob">Enter DOB:</label>
    <input name="DOB"  type="date" class="form-control" id="date" required >
  </div>
  <br><br>
  <div class="form-check mx-auto col-md-6">
    <input  type="checkbox" class="form-check-input" id="check" required >
    <label class="form-check-label" for="Check">accept all terms and condition</label>
    <br><br>
  <button type="submit" class="btn btn-success "onclick="validate(),saveuserform()">Submit</button>
  </div>
  
</form> 
<br>
<br>
<div id="contain">
  <div  >
    <h2>Entries</h2>
    <div  id="user-entries"></div>
  </div>
</div>
</div>
<script>
  let date = document.getElementById("date");
  let todayDate=new Date();
  let flag=0;
  function validate (){
  let tempDate=new Date(date.value);
  let diffTime=Math.abs(todayDate-tempDate);
  let diffYears=Math.ceil(diffTime/(1000 *60 *60*24*365.25));
  console.log(diffYears);
  if(diffYears>=18 && diffYears<=55){
    flag=1;
    return;
  }
  if(diffYears>=18 || diffYears<=55){
    alert("Enter date between  18-55");
    flag=0;
    return;
  }
  if(diffYears=""){
    alert("Enter Date");
    flag=0;
    return;
  }
  function call(){
    if(flag==1){
      return true;
    }
    return false;
  }
}

/// Table CONFIG


  let userform=document.getElementById("user-form");

  const retrieveentries=()=>{
    let entries=localStorage.getItem("user-entries");
    if(entries){
      let val=JSON.parse(entries);
      return ( val)
    }
    else{
      entries=[];
      
    }
    return entries
  }
  let userentries=retrieveentries();
  
  console.warn(typeof userentries)
  const displayentries=()=>{
  const entries=retrieveentries(); 
  const tableentries=entries.map((entry)=>{
    const namecell=`<td class="border px-4 py-2">${entry.name}</td>`;
    const emailcell=`<td class="border px-4 py-2">${entry.email}</td>`;
    const passcell=`<td class="border px-4 py-2">${entry.password}</td>`;
    const dobcell=`<td class="border px-4 py-2">${entry.date}</td>`;
    const acceptcell=`<td class="border px-4 py-2">${entry.check}</td>`;
    const row=`<tr >${namecell} ${emailcell} ${passcell} ${dobcell} ${acceptcell}</tr>`;
    
    return row;
  }).join('');
  
  const table=`<table class=table-auto w-full ><tr>
    <th class="px-4 py-2">Name</th> 
    <th class="px-4 py-2">Email</th>
    <th class="px-4 py-2">Password</th>
    <th class="px-4 py-2">Dob</th>
    <th class="px-4 py-2">Accepted Terms?</th></tr> ${tableentries}
    </table>`;
    let details=document.getElementById('user-entries');
    console.log(details);
    details.innerHTML=table;
 
}
const saveuserform=()=>{
  if(flag=1){
  const name=document.getElementById('name').value;
  const email=document.getElementById('email').value;
  const password=document.getElementById('password').value;
  const date=document.getElementById('date').value;
  const check=document.getElementById('check').checked;
  const entry={name,email,password,date,check}; 
  userentries.push(entry);
  localStorage.setItem("user-entries",JSON.stringify(userentries));
  displayentries();
  }
}
localStorage.clear();
displayentries();

</script>
</body>
</html>
